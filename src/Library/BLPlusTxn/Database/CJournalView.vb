''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' File          : CJournalView.vb
' Class         : CJournalView
' Description   : Table : JournalView, This Class is Generated By DBCG Tools Automatically
' Author        : Su Jia
' Creation Ver  : 2.1.0.0
'
' Revision History
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' Version       Date                 User
' $Log: CJournalView.vb,v $
' Revision 1.0  2012/08/24           Su Jia
' Initial Version
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Imports ServerPlatform.Library.Utility
Imports ServerPlatform.Library.Workflow

Public Class CJournalView
    Implements ICloneable
    Private Curser As New List(Of Object)

    Public Property JournalId As Integer
    Public Property GroupId As String
    Public Property TxnCode As String
    Public Property Title As String
    Public Property Status As Integer
    Public Property StatusDescription As String
    Public Property ErrCode As String
    Public Property ErrDescription As String
    Public Property ProcTime As String
    Public Property HostId As Integer
    Public Property HostName As String
    Public Property TraceNo As Integer
    Public Property SystemDate As DateTime
    Public Property BusinessDate As DateTime
    Public Property Teller As Integer
    Public Property TellerName As String
    Public Property BranchId As Integer
    Public Property Supervisor As Integer
    Public Property SupervisorName As String
    Public Property Account As String
    Public Property Currency As String
    Public Property TxnAmount As Double
    Public Property Terminal As Integer
    Public Property PageData As String
    Public Property OverrideId As String
    Public Property ReversalTxn As String

    Public Sub New()
        JournalId = 0
        GroupId = ""
        TxnCode = ""
        Title = ""
        Status = 0
        StatusDescription = ""
        ErrCode = ""
        ErrDescription = ""
        ProcTime = ""
        HostId = 0
        HostName = ""
        TraceNo = 0
        SystemDate = Now()
        BusinessDate = Now()
        Teller = 0
        TellerName = ""
        BranchId = 0
        Supervisor = 0
        SupervisorName = ""
        Account = ""
        Currency = ""
        TxnAmount = 0
        Terminal = 0
        PageData = ""
        OverrideId = ""
        ReversalTxn = ""
    End Sub

    Private Sub ToSqlPK(ByRef DBStruct As CJournalViewStruct)
    End Sub

    Private Sub ToSql(ByRef DBStruct As CJournalViewStruct)
        ToSqlPK(DBStruct)
        DBStruct.JournalId = JournalId
        DBStruct.GroupId = GroupId
        DBStruct.TxnCode = TxnCode
        DBStruct.Title = Title
        DBStruct.Status = Status
        DBStruct.StatusDescription = StatusDescription
        DBStruct.ErrCode = ErrCode
        DBStruct.ErrDescription = ErrDescription
        DBStruct.ProcTime = ProcTime
        DBStruct.HostId = HostId
        DBStruct.HostName = HostName
        DBStruct.TraceNo = TraceNo
        DBStruct.SystemDate = SystemDate
        DBStruct.BusinessDate = BusinessDate
        DBStruct.Teller = Teller
        DBStruct.TellerName = TellerName
        DBStruct.BranchId = BranchId
        DBStruct.Supervisor = Supervisor
        DBStruct.SupervisorName = SupervisorName
        DBStruct.Account = Account
        DBStruct.Currency = Currency
        DBStruct.TxnAmount = TxnAmount
        DBStruct.Terminal = Terminal
        DBStruct.PageData = PageData
        DBStruct.OverrideId = OverrideId
        DBStruct.ReversalTxn = ReversalTxn
    End Sub

    Private Sub FromSql(ByVal DBStruct As CJournalViewStruct)
        JournalId = DBStruct.JournalId
        GroupId = DBStruct.GroupId
        TxnCode = DBStruct.TxnCode
        Title = DBStruct.Title
        Status = DBStruct.Status
        StatusDescription = DBStruct.StatusDescription
        ErrCode = DBStruct.ErrCode
        ErrDescription = DBStruct.ErrDescription
        ProcTime = DBStruct.ProcTime
        HostId = DBStruct.HostId
        HostName = DBStruct.HostName
        TraceNo = DBStruct.TraceNo
        SystemDate = DBStruct.SystemDate
        BusinessDate = DBStruct.BusinessDate
        Teller = DBStruct.Teller
        TellerName = DBStruct.TellerName
        BranchId = DBStruct.BranchId
        Supervisor = DBStruct.Supervisor
        SupervisorName = DBStruct.SupervisorName
        Account = DBStruct.Account
        Currency = DBStruct.Currency
        TxnAmount = DBStruct.TxnAmount
        Terminal = DBStruct.Terminal
        PageData = DBStruct.PageData
        OverrideId = DBStruct.OverrideId
        ReversalTxn = DBStruct.ReversalTxn
    End Sub

    Public Sub Insert(ByRef DatabaseFactory As CDatabaseFactory)
        Dim StructObj As New CJournalViewStruct
        ToSql(StructObj)

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.Insert(DatabaseFactory.CreateInstance, StructObj)
    End Sub

    Public Sub Update(ByRef DatabaseFactory As CDatabaseFactory)
        Dim StructObj As New CJournalViewStruct
        ToSql(StructObj)

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.Update(DatabaseFactory.CreateInstance, StructObj)
    End Sub

    Public Sub Remove(ByRef DatabaseFactory As CDatabaseFactory)
        Dim StructObj As New CJournalViewStruct
        ToSql(StructObj)

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.Remove(DatabaseFactory.CreateInstance, StructObj)
    End Sub

    Public Sub Search(ByRef DatabaseFactory As CDatabaseFactory, _
                    ByVal Lock As Boolean?)

        Dim StructObj As New CJournalViewStruct
        ToSqlPK(StructObj)

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.Search(DatabaseFactory.CreateInstance, StructObj, Lock)
        FromSql(StructObj)
    End Sub

    Public Shared Sub SearchAll(ByRef DatabaseFactory As CDatabaseFactory, ByRef ObjList As List(Of CJournalView))

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary("JournalView")

        Dim StructObjList As New List(Of Object)
        DBAccessClass.SearchAll(DatabaseFactory.CreateInstance, StructObjList)

        For Each StructObj As CJournalViewStruct In StructObjList
            Dim Obj As New CJournalView
            Obj.FromSql(StructObj)
            ObjList.Add(Obj)
        Next
    End Sub


    Public Sub SearchOrderById(ByRef DatabaseFactory As CDatabaseFactory, _
                    ByVal Index As Integer, ByVal Lock As Boolean?, Optional ByVal MaxRecord As Integer = 0)
        If Curser.Count > 0 Then
            If Index <= Curser.Count - 1 Then
                FromSql(Curser.Item(Index))
                Exit Sub
            Else
                Throw New CError.CBusinessException(CError.CErrorCode.RECORD_NOT_FOUND, "Index Out Of Range")
            End If
        End If

        Dim StructObj As New CJournalViewStruct
        StructObj.MaxRecord = MaxRecord

        Dim DBAccessClass As Object = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.SearchOrderById(DatabaseFactory.CreateInstance, StructObj, Curser, Lock)

        FromSql(Curser.Item(Index))

    End Sub

    Public Sub SearchByGroupAndUser(ByRef DatabaseFactory As CDatabaseFactory, _
                    ByVal GroupId As String, _
                    ByVal Teller As Integer, _
                    ByVal Index As Integer, ByVal Lock As Boolean?, Optional ByVal MaxRecord As Integer = 0)
        If Curser.Count > 0 Then
            If Index <= Curser.Count - 1 Then
                FromSql(Curser.Item(Index))
                Exit Sub
            Else
                Throw New CError.CBusinessException(CError.CErrorCode.RECORD_NOT_FOUND, "Index Out Of Range")
            End If
        End If

        Dim StructObj As New CJournalViewStruct
        StructObj.GroupId = GroupId
        StructObj.Teller = Teller
        StructObj.MaxRecord = MaxRecord

        Dim DBAccessClass As Object = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.SearchByGroupAndUser(DatabaseFactory.CreateInstance, StructObj, Curser, Lock)

        FromSql(Curser.Item(Index))

    End Sub

    Public Sub SearchByTxnCode(ByRef DatabaseFactory As CDatabaseFactory, _
                    ByVal TxnCode As String, _
                    ByVal Index As Integer, ByVal Lock As Boolean?, Optional ByVal MaxRecord As Integer = 0)
        If Curser.Count > 0 Then
            If Index <= Curser.Count - 1 Then
                FromSql(Curser.Item(Index))
                Exit Sub
            Else
                Throw New CError.CBusinessException(CError.CErrorCode.RECORD_NOT_FOUND, "Index Out Of Range")
            End If
        End If

        Dim StructObj As New CJournalViewStruct
        StructObj.TxnCode = TxnCode
        StructObj.MaxRecord = MaxRecord

        Dim DBAccessClass As Object = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.SearchByTxnCode(DatabaseFactory.CreateInstance, StructObj, Curser, Lock)

        FromSql(Curser.Item(Index))

    End Sub

    Public Function Count(ByRef DatabaseFactory As CDatabaseFactory) As Integer

        Dim StructObj As New CJournalViewStruct

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        Return DBAccessClass.Count(DatabaseFactory.CreateInstance)
    End Function

    Public ReadOnly Property ClassName As String
        Get
            Return "JournalView"
        End Get
    End Property

    Public Overridable Function Clone() As Object Implements ICloneable.Clone
        Dim JournalView As New CJournalView
        JournalView.JournalId = JournalId
        JournalView.GroupId = GroupId
        JournalView.TxnCode = TxnCode
        JournalView.Title = Title
        JournalView.Status = Status
        JournalView.StatusDescription = StatusDescription
        JournalView.ErrCode = ErrCode
        JournalView.ErrDescription = ErrDescription
        JournalView.ProcTime = ProcTime
        JournalView.HostId = HostId
        JournalView.HostName = HostName
        JournalView.TraceNo = TraceNo
        JournalView.SystemDate = SystemDate
        JournalView.BusinessDate = BusinessDate
        JournalView.Teller = Teller
        JournalView.TellerName = TellerName
        JournalView.BranchId = BranchId
        JournalView.Supervisor = Supervisor
        JournalView.SupervisorName = SupervisorName
        JournalView.Account = Account
        JournalView.Currency = Currency
        JournalView.TxnAmount = TxnAmount
        JournalView.Terminal = Terminal
        JournalView.PageData = PageData
        JournalView.OverrideId = OverrideId
        JournalView.ReversalTxn = ReversalTxn
        Return JournalView
    End Function



End Class


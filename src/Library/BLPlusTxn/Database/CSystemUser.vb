''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' File          : CSystemUser.vb
' Class         : CSystemUser
' Description   : Table : SystemUser, This Class is Generated By DBCG Tools Automatically
' Author        : Su Jia
' Creation Ver  : 2.1.0.0
'
' Revision History
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' Version       Date                 User
' $Log: CSystemUser.vb,v $
' Revision 1.0  2012/08/24           Su Jia
' Initial Version
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Imports ServerPlatform.Library.Utility
Imports ServerPlatform.Library.Workflow

Public Class CSystemUser
    Implements ICloneable
    Private Curser As New List(Of Object)

    Public Property UserId As Integer
    Public Property UserAlias As String
    Public Property Email As String
    Public Property FirstName As String
    Public Property LastName As String
    Public Property MiddleName As String
    Public Property FullName As String
    Public Property Gender As Short
    Public Property RegisterDate As DateTime
    Public Property LastLoginDate As DateTime
    Public Property Branch As Integer
    Public Property Photo As String
    Public Property PinBlock As String
    Public Property ContactNo As String
    Public Property ContactNo2 As String
    Public Property Nationality As String

    Public Sub New()
        UserId = 0
        UserAlias = ""
        Email = ""
        FirstName = ""
        LastName = ""
        MiddleName = ""
        FullName = ""
        Gender = 0
        RegisterDate = NOW()
        LastLoginDate = NOW()
        Branch = 0
        Photo = ""
        PinBlock = ""
        ContactNo = ""
        ContactNo2 = ""
        Nationality = ""
    End Sub

    Private Sub ToSqlPK(ByRef DBStruct As CSystemUserStruct)
        DBStruct.UserId = UserId
    End Sub

    Private Sub ToSql(ByRef DBStruct As CSystemUserStruct)
        ToSqlPK(DBStruct)
        DBStruct.UserAlias = UserAlias
        DBStruct.Email = Email
        DBStruct.FirstName = FirstName
        DBStruct.LastName = LastName
        DBStruct.MiddleName = MiddleName
        DBStruct.FullName = FullName
        DBStruct.Gender = Gender
        DBStruct.RegisterDate = RegisterDate
        DBStruct.LastLoginDate = LastLoginDate
        DBStruct.Branch = Branch
        DBStruct.Photo = Photo
        DBStruct.PinBlock = PinBlock
        DBStruct.ContactNo = ContactNo
        DBStruct.ContactNo2 = ContactNo2
        DBStruct.Nationality = Nationality
    End Sub

    Private Sub FromSql(ByVal DBStruct As CSystemUserStruct)
        UserId = DBStruct.UserId
        UserAlias = DBStruct.UserAlias
        Email = DBStruct.Email
        FirstName = DBStruct.FirstName
        LastName = DBStruct.LastName
        MiddleName = DBStruct.MiddleName
        FullName = DBStruct.FullName
        Gender = DBStruct.Gender
        RegisterDate = DBStruct.RegisterDate
        LastLoginDate = DBStruct.LastLoginDate
        Branch = DBStruct.Branch
        Photo = DBStruct.Photo
        PinBlock = DBStruct.PinBlock
        ContactNo = DBStruct.ContactNo
        ContactNo2 = DBStruct.ContactNo2
        Nationality = DBStruct.Nationality
    End Sub

    Public Sub Insert(ByRef DatabaseFactory As CDatabaseFactory)
        Dim StructObj As New CSystemUserStruct
        ToSql(StructObj)

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.Insert(DatabaseFactory.CreateInstance, StructObj)
    End Sub

    Public Sub Update(ByRef DatabaseFactory As CDatabaseFactory)
        Dim StructObj As New CSystemUserStruct
        ToSql(StructObj)

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.Update(DatabaseFactory.CreateInstance, StructObj)
    End Sub

    Public Sub Remove(ByRef DatabaseFactory As CDatabaseFactory)
        Dim StructObj As New CSystemUserStruct
        ToSql(StructObj)

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.Remove(DatabaseFactory.CreateInstance, StructObj)
    End Sub

    Public Sub Search(ByRef DatabaseFactory As CDatabaseFactory, _
                    ByVal UserId As Integer, _
                    ByVal Lock As Boolean?)

        Dim StructObj As New CSystemUserStruct
        Me.UserId = UserId
        ToSqlPK(StructObj)

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.Search(DatabaseFactory.CreateInstance, StructObj, Lock)
        FromSql(StructObj)
    End Sub

    Public Shared Sub SearchAll(ByRef DatabaseFactory As CDatabaseFactory, ByRef ObjList As List(Of CSystemUser))

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary("SystemUser")

        Dim StructObjList As New List(Of Object)
        DBAccessClass.SearchAll(DatabaseFactory.CreateInstance, StructObjList)

        For Each StructObj As CSystemUserStruct In StructObjList
            Dim Obj As New CSystemUser
            Obj.FromSql(StructObj)
            ObjList.Add(Obj)
        Next
    End Sub


    Public Function Count(ByRef DatabaseFactory As CDatabaseFactory) As Integer

        Dim StructObj As New CSystemUserStruct

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        Return DBAccessClass.Count(DatabaseFactory.CreateInstance)
    End Function

    Public ReadOnly Property ClassName As String
        Get
            Return "SystemUser"
        End Get
    End Property

    Public Overridable Function Clone() As Object Implements ICloneable.Clone
        Dim SystemUser As New CSystemUser
        SystemUser.UserId = UserId
        SystemUser.UserAlias = UserAlias
        SystemUser.Email = Email
        SystemUser.FirstName = FirstName
        SystemUser.LastName = LastName
        SystemUser.MiddleName = MiddleName
        SystemUser.FullName = FullName
        SystemUser.Gender = Gender
        SystemUser.RegisterDate = RegisterDate
        SystemUser.LastLoginDate = LastLoginDate
        SystemUser.Branch = Branch
        SystemUser.Photo = Photo
        SystemUser.PinBlock = PinBlock
        SystemUser.ContactNo = ContactNo
        SystemUser.ContactNo2 = ContactNo2
        SystemUser.Nationality = Nationality
        Return SystemUser
    End Function



End Class


''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' File          : CJournal.vb
' Class         : CJournal
' Description   : Table : Journal, This Class is Generated By DBCG Tools Automatically
' Author        : Su Jia
' Creation Ver  : 2.1.0.0
'
' Revision History
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' Version       Date                 User
' $Log: CJournal.vb,v $
' Revision 1.0  2012/08/24           Su Jia
' Initial Version
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Imports ServerPlatform.Library.Utility
Imports ServerPlatform.Library.Workflow

Public Class CJournal
    Implements ICloneable
    Private Curser As New List(Of Object)

    Public Property JournalId As Integer
    Public Property GroupId As String
    Public Property TxnCode As String
    Public Property Status As Integer
    Public Property ErrCode As String
    Public Property ErrDescription As String
    Public Property HostId As String
    Public Property TraceNo As String
    Public Property SystemDate As DateTime
    Public Property BusinessDate As DateTime
    Public Property UserId As Integer
    Public Property BranchId As Integer
    Public Property Supervisor As Integer
    Public Property Account As String
    Public Property Amount As Double
    Public Property Currency As String
    Public Property Request As String
    Public Property Response As String
    Public Property Terminal As Integer
    Public Property ProcTime As Long
    Public Property PageData As String
    Public Property OverrideId As String

    Public Sub New()
        JournalId = 
        GroupId = ""
        TxnCode = ""
        Status = 0
        ErrCode = ""
        ErrDescription = ""
        HostId = ""
        TraceNo = ""
        SystemDate = NOW()
        BusinessDate = NOW()
        UserId = 0
        BranchId = 0
        Supervisor = 0
        Account = ""
        Amount = 0
        Currency = ""
        Request = ""
        Response = ""
        Terminal = 0
        ProcTime = 0
        PageData = ""
        OverrideId = ""
    End Sub

    Private Sub ToSqlPK(ByRef DBStruct As CJournalStruct)
        DBStruct.JournalId = JournalId
    End Sub

    Private Sub ToSql(ByRef DBStruct As CJournalStruct)
        ToSqlPK(DBStruct)
        DBStruct.GroupId = GroupId
        DBStruct.TxnCode = TxnCode
        DBStruct.Status = Status
        DBStruct.ErrCode = ErrCode
        DBStruct.ErrDescription = ErrDescription
        DBStruct.HostId = HostId
        DBStruct.TraceNo = TraceNo
        DBStruct.SystemDate = SystemDate
        DBStruct.BusinessDate = BusinessDate
        DBStruct.UserId = UserId
        DBStruct.BranchId = BranchId
        DBStruct.Supervisor = Supervisor
        DBStruct.Account = Account
        DBStruct.Amount = Amount
        DBStruct.Currency = Currency
        DBStruct.Request = Request
        DBStruct.Response = Response
        DBStruct.Terminal = Terminal
        DBStruct.ProcTime = ProcTime
        DBStruct.PageData = PageData
        DBStruct.OverrideId = OverrideId
    End Sub

    Private Sub FromSql(ByVal DBStruct As CJournalStruct)
        JournalId = DBStruct.JournalId
        GroupId = DBStruct.GroupId
        TxnCode = DBStruct.TxnCode
        Status = DBStruct.Status
        ErrCode = DBStruct.ErrCode
        ErrDescription = DBStruct.ErrDescription
        HostId = DBStruct.HostId
        TraceNo = DBStruct.TraceNo
        SystemDate = DBStruct.SystemDate
        BusinessDate = DBStruct.BusinessDate
        UserId = DBStruct.UserId
        BranchId = DBStruct.BranchId
        Supervisor = DBStruct.Supervisor
        Account = DBStruct.Account
        Amount = DBStruct.Amount
        Currency = DBStruct.Currency
        Request = DBStruct.Request
        Response = DBStruct.Response
        Terminal = DBStruct.Terminal
        ProcTime = DBStruct.ProcTime
        PageData = DBStruct.PageData
        OverrideId = DBStruct.OverrideId
    End Sub

    Public Sub Insert(ByRef DatabaseFactory As CDatabaseFactory)
        Dim StructObj As New CJournalStruct
        ToSql(StructObj)

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.Insert(DatabaseFactory.CreateInstance, StructObj)
        JournalId = StructObj.JournalId
    End Sub

    Public Sub Update(ByRef DatabaseFactory As CDatabaseFactory)
        Dim StructObj As New CJournalStruct
        ToSql(StructObj)

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.Update(DatabaseFactory.CreateInstance, StructObj)
    End Sub

    Public Sub Remove(ByRef DatabaseFactory As CDatabaseFactory)
        Dim StructObj As New CJournalStruct
        ToSql(StructObj)

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.Remove(DatabaseFactory.CreateInstance, StructObj)
    End Sub

    Public Sub Search(ByRef DatabaseFactory As CDatabaseFactory, _
                    ByVal JournalId As Integer, _
                    ByVal Lock As Boolean?)

        Dim StructObj As New CJournalStruct
        Me.JournalId = JournalId
        ToSqlPK(StructObj)

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.Search(DatabaseFactory.CreateInstance, StructObj, Lock)
        FromSql(StructObj)
    End Sub

    Public Shared Sub SearchAll(ByRef DatabaseFactory As CDatabaseFactory, ByRef ObjList As List(Of CJournal))

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary("Journal")

        Dim StructObjList As New List(Of Object)
        DBAccessClass.SearchAll(DatabaseFactory.CreateInstance, StructObjList)

        For Each StructObj As CJournalStruct In StructObjList
            Dim Obj As New CJournal
            Obj.FromSql(StructObj)
            ObjList.Add(Obj)
        Next
    End Sub


    Public Function Count(ByRef DatabaseFactory As CDatabaseFactory) As Integer

        Dim StructObj As New CJournalStruct

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        Return DBAccessClass.Count(DatabaseFactory.CreateInstance)
    End Function

    Public ReadOnly Property ClassName As String
        Get
            Return "Journal"
        End Get
    End Property

    Public Overridable Function Clone() As Object Implements ICloneable.Clone
        Dim Journal As New CJournal
        Journal.JournalId = JournalId
        Journal.GroupId = GroupId
        Journal.TxnCode = TxnCode
        Journal.Status = Status
        Journal.ErrCode = ErrCode
        Journal.ErrDescription = ErrDescription
        Journal.HostId = HostId
        Journal.TraceNo = TraceNo
        Journal.SystemDate = SystemDate
        Journal.BusinessDate = BusinessDate
        Journal.UserId = UserId
        Journal.BranchId = BranchId
        Journal.Supervisor = Supervisor
        Journal.Account = Account
        Journal.Amount = Amount
        Journal.Currency = Currency
        Journal.Request = Request
        Journal.Response = Response
        Journal.Terminal = Terminal
        Journal.ProcTime = ProcTime
        Journal.PageData = PageData
        Journal.OverrideId = OverrideId
        Return Journal
    End Function

#Region "User Defined Code"
    Public Enum CJournalStatus As Integer
        Successful = 0
        Fail = 1
        Unknow = 9
    End Enum

#End Region


End Class


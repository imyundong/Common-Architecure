''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' File          : CMultiTxnSeq.vb
' Class         : CMultiTxnSeq
' Description   : Table : MultiTxnSeq, This Class is Generated By DBCG Tools Automatically
' Author        : Su Jia
' Creation Ver  : 2.1.0.0
'
' Revision History
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' Version       Date                 User
' $Log: CMultiTxnSeq.vb,v $
' Revision 1.0  2012/08/24           Su Jia
' Initial Version
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Imports ServerPlatform.Library.Utility
Imports ServerPlatform.Library.Workflow

Public Class CMultiTxnSeq
    Implements ICloneable
    Private Curser As New List(Of Object)

    Public Property BANKCD As String
    Public Property BRANCHCD As String
    Public Property BUSINESSDATE As DateTime
    Public Property MULTISEQ As Integer
    Public Property EJSEQ As Integer
    Public Property DRAMT As Double
    Public Property CRAMT As Double
    Public Property TXNCD As String
    Public Property USERID As String
    Public Property TOACCTNO As String

    Public Sub New()
        BANKCD = "0"
        BRANCHCD = "0"
        BUSINESSDATE = NOW()
        MULTISEQ = 0
        EJSEQ = 0
        DRAMT = 0
        CRAMT = 0
        TXNCD = ""
        USERID = ""
        TOACCTNO = ""
    End Sub

    Private Sub ToSqlPK(ByRef DBStruct As CMultiTxnSeqStruct)
        DBStruct.BANKCD = BANKCD
        DBStruct.BRANCHCD = BRANCHCD
        DBStruct.BUSINESSDATE = BUSINESSDATE
        DBStruct.MULTISEQ = MULTISEQ
    End Sub

    Private Sub ToSql(ByRef DBStruct As CMultiTxnSeqStruct)
        ToSqlPK(DBStruct)
        DBStruct.EJSEQ = EJSEQ
        DBStruct.DRAMT = DRAMT
        DBStruct.CRAMT = CRAMT
        DBStruct.TXNCD = TXNCD
        DBStruct.USERID = USERID
        DBStruct.TOACCTNO = TOACCTNO
    End Sub

    Private Sub FromSql(ByVal DBStruct As CMultiTxnSeqStruct)
        BANKCD = DBStruct.BANKCD
        BRANCHCD = DBStruct.BRANCHCD
        BUSINESSDATE = DBStruct.BUSINESSDATE
        MULTISEQ = DBStruct.MULTISEQ
        EJSEQ = DBStruct.EJSEQ
        DRAMT = DBStruct.DRAMT
        CRAMT = DBStruct.CRAMT
        TXNCD = DBStruct.TXNCD
        USERID = DBStruct.USERID
        TOACCTNO = DBStruct.TOACCTNO
    End Sub

    Public Sub Insert(ByRef DatabaseFactory As CDatabaseFactory)
        Dim StructObj As New CMultiTxnSeqStruct
        ToSql(StructObj)

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.Insert(DatabaseFactory.CreateInstance, StructObj)
    End Sub

    Public Sub Update(ByRef DatabaseFactory As CDatabaseFactory)
        Dim StructObj As New CMultiTxnSeqStruct
        ToSql(StructObj)

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.Update(DatabaseFactory.CreateInstance, StructObj)
    End Sub

    Public Sub Remove(ByRef DatabaseFactory As CDatabaseFactory)
        Dim StructObj As New CMultiTxnSeqStruct
        ToSql(StructObj)

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.Update(DatabaseFactory.CreateInstance, StructObj)
    End Sub

    Public Sub Search(ByRef DatabaseFactory As CDatabaseFactory, _
                    ByVal BANKCD As String, _
                    ByVal BRANCHCD As String, _
                    ByVal BUSINESSDATE As DateTime, _
                    ByVal MULTISEQ As Integer, _
                    ByVal Lock As Boolean?)

        Dim StructObj As New CMultiTxnSeqStruct
        Me.BANKCD = BANKCD
        Me.BRANCHCD = BRANCHCD
        Me.BUSINESSDATE = BUSINESSDATE
        Me.MULTISEQ = MULTISEQ
        ToSqlPK(StructObj)

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.Search(DatabaseFactory.CreateInstance, StructObj, Lock)
        FromSql(StructObj)
    End Sub

    Public Sub SearchAll(ByRef DatabaseFactory As CDatabaseFactory, ByRef ObjList As List(Of CMultiTxnSeq))

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)

        Dim StructObjList As New List(Of Object)
        DBAccessClass.SearchAll(DatabaseFactory.CreateInstance, StructObjList)

        For Each StructObj As CMultiTxnSeqStruct In StructObjList
            Dim Obj As New CMultiTxnSeq
            Obj.FromSql(StructObj)
            ObjList.Add(Obj)
        Next
    End Sub


    Public Sub SearchByTellerBusinessDate(ByRef DatabaseFactory As CDatabaseFactory, _
                    ByVal USERID As String, _
                    ByVal BUSINESSDATE As DateTime, _
                    ByVal Index As Integer, ByVal Lock As Boolean?, Optional ByVal MaxRecord As Integer = 0)
        If Curser.Count > 0 Then
            If Index <= Curser.Count - 1 Then
                FromSql(Curser.Item(Index))
                Exit Sub
            Else
                Throw New CError.CBusinessException(CError.CErrorCode.RECORD_NOT_FOUND, "Index Out Of Range")
            End If
        End If

        Dim StructObj As New CMultiTxnSeqStruct
        StructObj.USERID = USERID
        StructObj.BUSINESSDATE = BUSINESSDATE
        StructObj.MaxRecord = MaxRecord

        Dim DBAccessClass As Object = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        DBAccessClass.SearchByTellerBusinessDate(DatabaseFactory.CreateInstance, StructObj, Curser, Lock)

        FromSql(Curser.Item(Index))

    End Sub

    Public Function Count(ByRef DatabaseFactory As CDatabaseFactory) As Integer

        Dim StructObj As New CMultiTxnSeqStruct

        Dim DBAccessClass As IDatabaseAccess = DatabaseFactory.GetDatabaseAccessLibrary(ClassName)
        Return DBAccessClass.Count(DatabaseFactory.CreateInstance)
    End Function

    Public ReadOnly Property ClassName As String
        Get
            Return "MultiTxnSeq"
        End Get
    End Property

    Public Function Clone() As Object Implements ICloneable.Clone
        Dim MultiTxnSeq As New CMultiTxnSeq
        MultiTxnSeq.BANKCD = BANKCD
        MultiTxnSeq.BRANCHCD = BRANCHCD
        MultiTxnSeq.BUSINESSDATE = BUSINESSDATE
        MultiTxnSeq.MULTISEQ = MULTISEQ
        MultiTxnSeq.EJSEQ = EJSEQ
        MultiTxnSeq.DRAMT = DRAMT
        MultiTxnSeq.CRAMT = CRAMT
        MultiTxnSeq.TXNCD = TXNCD
        MultiTxnSeq.USERID = USERID
        MultiTxnSeq.TOACCTNO = TOACCTNO
        Return MultiTxnSeq
    End Function



End Class

